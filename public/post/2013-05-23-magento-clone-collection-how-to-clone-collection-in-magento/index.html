<!DOCTYPE html>
<html lang="en-US">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" />
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="shortcut icon" href="http://localhost:1313/images/favicon.png" />
<title>Magento clone collection &amp;#8211; How to clone collection in Magento | Kalpesh Mehta&#39;s Blog</title>
<meta name="title" content="Magento clone collection &amp;#8211; How to clone collection in Magento" />
<meta name="description" content="Clone collection in Magento in an easy and effective way. Cloning collection in Magento is not as straight forward as we do in PHP object cloning. That’s because Magento does not implement clone in it’s collection object, which is why if you try to clone Magento collection it will nothing but just a copy of the original collection itself. If the original collection gets updated, this cloned will also get updated, which is what we don’t want right?" />
<meta name="author" content="kalpesh" />
<meta name="keywords" content="clone,collection,magento," />






  





  













<meta property="og:title" content="Magento clone collection &amp;#8211; How to clone collection in Magento" />
<meta property="og:description" content="Clone collection in Magento in an easy and effective way. Cloning collection in Magento is not as straight forward as we do in PHP object cloning. That’s because Magento does not implement clone in it’s collection object, which is why if you try to clone Magento collection it will nothing but just a copy of the original collection itself. If the original collection gets updated, this cloned will also get updated, which is what we don’t want right?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/post/2013-05-23-magento-clone-collection-how-to-clone-collection-in-magento/" />

<meta property="og:image" content="http://localhost:1313/images/social_card_bg_hu_52681dbfd4a78db7.webp"/><meta property="article:section" content="post" />
<meta property="article:published_time" content="2013-05-23T09:03:43+00:00" />
<meta property="article:modified_time" content="2013-05-23T09:03:43+00:00" /><meta property="og:site_name" content="Kalpesh Mehta" />
<meta property="fb:admins" content="0000000000" />



<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="http://localhost:1313/images/social_card_bg_hu_52681dbfd4a78db7.webp"/>
<meta name="twitter:title" content="Magento clone collection &amp;#8211; How to clone collection in Magento"/>
<meta name="twitter:description" content="Clone collection in Magento in an easy and effective way. Cloning collection in Magento is not as straight forward as we do in PHP object cloning. That’s because Magento does not implement clone in it’s collection object, which is why if you try to clone Magento collection it will nothing but just a copy of the original collection itself. If the original collection gets updated, this cloned will also get updated, which is what we don’t want right?"/>
<meta name="twitter:site" content="@kalpmehta"/>



<meta itemprop="name" content="Magento clone collection &amp;#8211; How to clone collection in Magento">
<meta itemprop="description" content="Clone collection in Magento in an easy and effective way. Cloning collection in Magento is not as straight forward as we do in PHP object cloning. That’s because Magento does not implement clone in it’s collection object, which is why if you try to clone Magento collection it will nothing but just a copy of the original collection itself. If the original collection gets updated, this cloned will also get updated, which is what we don’t want right?"><meta itemprop="datePublished" content="2013-05-23T09:03:43+00:00" />
<meta itemprop="dateModified" content="2013-05-23T09:03:43+00:00" />
<meta itemprop="wordCount" content="353">

<meta itemprop="image" content="http://localhost:1313/images/social_card_bg_hu_52681dbfd4a78db7.webp"/>


<meta itemprop="keywords" content="clone,collection,magento," />

<meta name="referrer" content="no-referrer-when-downgrade" />

  
  <link href="/original.min.css" rel="stylesheet">

  

  

  
</head>

<body>
  <header><a class="skip-link" href="#main-content">Skip to main content</a>

<a href="/" class="title"><h1>Kalpesh Mehta&#39;s Blog</h1></a>
<nav>
<a href='http://localhost:1313/'>Home</a>
<a href='http://localhost:1313/about-me'>About Me</a>
<a href='http://localhost:1313/contact-me'>Contact</a>
<a href='http://localhost:1313/index.xml'>RSS</a>







</nav>
</header>
  <main id="main-content">

<h1>Magento clone collection &amp;#8211; How to clone collection in Magento</h1>
<p class="byline">
  <time datetime='2013-05-23' pubdate>
    2013-05-23
  </time>
  · kalpesh
</p>

<content>
  <p>Clone collection in Magento in an easy and effective way. Cloning collection in Magento is not as straight forward as we do in PHP object cloning. That’s because Magento does not implement clone in it’s collection object, which is why if you try to clone Magento collection it will nothing but just a copy of the original collection itself. If the original collection gets updated, this cloned will also get updated, which is what we don’t want right?</p>
<p>Let’s see an example where PHP’s clone keyword will fail. Consider you have an $collection in the class method and you want to perform operations on this $collection in two different ways. So you need to clone this $collection and perform operation differently in both the collections so that both collections have different result set.</p>
<p>{code type=php}$coll1 = clone $collection;<br>
$coll2 = clone $collection;{/code}</p>
<p>Let’s perform different operations on these two separate collections now, like this:</p>
<p>{code type=php}$coll1-&gt;getSelect()-&gt;where(‘first where condition’);<br>
$coll2-&gt;getSelect()-&gt;where(‘second where condition’);<br>
if($coll1-&gt;getSize() == 0) {<br>
$collection = $coll2;<br>
} else {<br>
$collection = $coll1;<br>
}{/code}</p>
<p>But this will fail and not work what we expect here. $collection here will hold BOTH the where conditions, instead of any one depending on the result of IF condition.</p>
<p>To overcome this, in Magento, what you have to do is:</p>
<p>{code type=php}//Assuming you have original collection as $collection<br>
$collection-&gt;getSelect()<br>
-&gt;joinLeft(‘table1 as table1alias’, ‘table1alias.entity_id=e.entity_id’,array(‘name’,’description’))<br>
-&gt;where(‘$firstWhereCondition’);</p>
<p>$coll = clone $collection;<br>
if($coll-&gt;getSize() == 0) {<br>
$fromPart = $collection-&gt;getSelect()-&gt;getPart(Zend_Db_Select::FROM); //getting all the FROM clause from collection<br>
$wherePart = $collection-&gt;getSelect()-&gt;getPart(Zend_Db_Select::WHERE); //getting all the WHERE clause conditions from collection<br>
//debug to see what you have to remove<br>
//print_r($fromPart);print_r($wherePart);exit;</p>
<p>unset($fromPart[‘table1alias’]); //removing table1 join which we did for first where condition<br>
unset($wherePart[0]); //removing first where condition, this may be different based on your query</p>
<p>//removed FROM and first WHERE condition from collection<br>
$collection-&gt;getSelect()-&gt;setPart(Zend_Db_Select::FROM, $fromPart);<br>
$collection-&gt;getSelect()-&gt;setPart(Zend_Db_Select::WHERE, $wherePart);</p>
<p>//now assign FROM and second WHERE condition to collection<br>
$collection-&gt;getSelect()<br>
-&gt;joinLeft(‘table1 as table1alias’, ‘table1alias.entity_id=e.entity_id’,array(‘name’,’description’))<br>
-&gt;where($secondWhereCondition);</p>
<p>//echo $collection-&gt;getSelect()-&gt;__toString();</p>
<p>}<br>
echo $collection-&gt;getSize();{/code}</p>
<p>That’s it! You have just used one collection and applied two where conditions. Similarly you can even apply multiple FROM and WHERE clause conditions as per the requirement.</p>
<p>HTH!</p>

</content>
<p>
  
    <a class="blog-tags" href="/blog/clone/">#clone</a>
  
    <a class="blog-tags" href="/blog/collection/">#collection</a>
  
    <a class="blog-tags" href="/blog/magento/">#magento</a>
  
</p>


  <p>
    <a href='mailto:k@lpe.sh?subject=Reply%20to%20"Magento%20clone%20collection%20%26%238211%3b%20How%20to%20clone%20collection%20in%20Magento"'>
      Reply to this post by email ↪
    </a>
  </p>



  </main>
  <footer><small>
  Copyright © 2025, Kalpesh Mehta. | 
</small></footer>

    
</body>

</html>
