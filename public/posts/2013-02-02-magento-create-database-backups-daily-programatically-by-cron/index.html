<!DOCTYPE html>
<html lang="en-US">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" />
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="shortcut icon" href="http://localhost:1313/images/favicon.png" />
<title>Magento: Create database backups daily programatically by cron | Hugo Ê•â€¢á´¥â€¢Ê” Bear Blog</title>
<meta name="title" content="Magento: Create database backups daily programatically by cron" />
<meta name="description" content="Itâ€™s a good practice to create your database backup every day/week. But to manually go to Magento admin and create backup daily is a cumbersome process. You canâ€™t guarantee that your database will be secure especially if you are on a cloud storage. Backups are MUST and if itâ€™s automated, life becomes very easier.
This code will create backup of your Magento DB and place it to var/backups directory.
{code type=php}public function backup()
{
try {" />
<meta name="author" content="kalpesh" />
<meta name="keywords" content="magento daily backup cron,magento database backup programatically,magento replace old database backups," />






  
  <meta property="og:url" content="http://localhost:1313/posts/2013-02-02-magento-create-database-backups-daily-programatically-by-cron/">
  <meta property="og:site_name" content="Hugo Ê•â€¢á´¥â€¢Ê” Bear Blog">
  <meta property="og:title" content="Magento: Create database backups daily programatically by cron">
  <meta property="og:description" content="Itâ€™s a good practice to create your database backup every day/week. But to manually go to Magento admin and create backup daily is a cumbersome process. You canâ€™t guarantee that your database will be secure especially if you are on a cloud storage. Backups are MUST and if itâ€™s automated, life becomes very easier.
This code will create backup of your Magento DB and place it to var/backups directory.
{code type=php}public function backup()
{
try {">
  <meta property="og:locale" content="en_US">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2013-02-02T20:18:58+00:00">
    <meta property="article:modified_time" content="2013-02-02T20:18:58+00:00">
    <meta property="article:tag" content="Magento Daily Backup Cron">
    <meta property="article:tag" content="Magento Database Backup Programatically">
    <meta property="article:tag" content="Magento Replace Old Database Backups">
    <meta property="og:image" content="http://localhost:1313/images/share.png">


  
  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/images/share.png">
  <meta name="twitter:title" content="Magento: Create database backups daily programatically by cron">
  <meta name="twitter:description" content="Itâ€™s a good practice to create your database backup every day/week. But to manually go to Magento admin and create backup daily is a cumbersome process. You canâ€™t guarantee that your database will be secure especially if you are on a cloud storage. Backups are MUST and if itâ€™s automated, life becomes very easier.
This code will create backup of your Magento DB and place it to var/backups directory.
{code type=php}public function backup()
{
try {">


  
  
  <meta itemprop="name" content="Magento: Create database backups daily programatically by cron">
  <meta itemprop="description" content="Itâ€™s a good practice to create your database backup every day/week. But to manually go to Magento admin and create backup daily is a cumbersome process. You canâ€™t guarantee that your database will be secure especially if you are on a cloud storage. Backups are MUST and if itâ€™s automated, life becomes very easier.
This code will create backup of your Magento DB and place it to var/backups directory.
{code type=php}public function backup()
{
try {">
  <meta itemprop="datePublished" content="2013-02-02T20:18:58+00:00">
  <meta itemprop="dateModified" content="2013-02-02T20:18:58+00:00">
  <meta itemprop="wordCount" content="347">
  <meta itemprop="image" content="http://localhost:1313/images/share.png">
  <meta itemprop="keywords" content="Magento Daily Backup Cron,Magento Database Backup Programatically,Magento Replace Old Database Backups">

<meta name="referrer" content="no-referrer-when-downgrade" />

  
  <link href="/original.min.css" rel="stylesheet">

  

  

  
</head>

<body>
  <header><a class="skip-link" href="#main-content">Skip to main content</a>

<a href="/" class="title"><h1>Hugo Ê•â€¢á´¥â€¢Ê” Bear Blog</h1></a>
<nav>
<a href='http://localhost:1313/index.xml'>RSS</a>







</nav>
</header>
  <main id="main-content">

<h1>Magento: Create database backups daily programatically by cron</h1>
<p class="byline">
  <time datetime='2013-02-02' pubdate>
    2013-02-02
  </time>
  Â· kalpesh
</p>

<content>
  <p>Itâ€™s a good practice to create your database backup every day/week. But to manually go to Magento admin and create backup daily is a cumbersome process. You canâ€™t guarantee that your database will be secure especially if you are on a cloud storage. Backups are MUST and if itâ€™s automated, life becomes very easier.</p>
<p>This code will create backup of your Magento DB and place it to var/backups directory.<br>
{code type=php}public function backup()<br>
{<br>
try {</p>
<p>$backupDb = Mage::getModel(â€˜backup/dbâ€™);<br>
$backup = Mage::getModel(â€˜backup/backupâ€™)<br>
-&gt;setTime(time())<br>
-&gt;setType(â€˜dbâ€™)<br>
-&gt;setPath(Mage::getBaseDir(â€œvarâ€) . DS . â€œbackupsâ€);</p>
<p>$backupDb-&gt;createBackup($backup);</p>
<p>return Mage::helper(â€˜coreâ€™)-&gt;__(â€˜Backup successfully createdâ€™);</p>
<p>} catch (Exception $e) {<br>
Mage::logException($e);<br>
}</p>
<p>return $this;<br>
}{/code}</p>
<p>Now, you can set the cron to run every midnight and call this above method to automatically create your DB backups. Sounds good? But there is a problem. As Magento DB size is huge, running daily/weekly backups will soon fill up your hardrives like hell.</p>
<p>So, we will now first create new DB database backup through our above method, and after itâ€™s created we will delete the older backups just to free up the disk space.</p>
<p>{code type=php}public function endsWith($haystack, $needle)<br>
{<br>
$length = strlen($needle);<br>
if ($length == 0) {<br>
return true;<br>
}</p>
<p>return (substr($haystack, -$length) === $needle);<br>
}</p>
<p>public function backup()<br>
{</p>
<p>//get all the older db backup files in an array<br>
$filelist = array();<br>
if ($handle = opendir(Mage::getBaseDir(â€˜varâ€™) . DS . â€œbackupsâ€ . DS)) {<br>
while ($entry = readdir($handle)) {<br>
if ($this-&gt;endsWith($entry, â€œ_db.gzâ€)) {<br>
$filelist[] = $entry;<br>
}<br>
}<br>
closedir($handle);<br>
}</p>
<p>try {<br>
//create the db backup<br>
$backupDb = Mage::getModel(â€˜backup/dbâ€™);<br>
$backup = Mage::getModel(â€˜backup/backupâ€™)<br>
-&gt;setTime(time())<br>
-&gt;setType(â€˜dbâ€™)<br>
-&gt;setPath(Mage::getBaseDir(â€œvarâ€) . DS . â€œbackupsâ€);</p>
<p>$backupDb-&gt;createBackup($backup);</p>
<p>//delete all older db backup files we found<br>
foreach((array)$filelist as $fileToDelete) {<br>
unlink(Mage::getBaseDir(â€œvarâ€) . DS . â€œbackupsâ€ . DS . $fileToDelete);<br>
}</p>
<p>return Mage::helper(â€˜coreâ€™)-&gt;__(â€˜Backup successfully createdâ€™);</p>
<p>} catch (Exception $e) {<br>
Mage::logException($e);<br>
}</p>
<p>return $this;<br>
}{/code}</p>
<p>Now you can set the CRON to run the file every midnight, which calls the above backup() method. You will now get daily fresh backups replacing the old ones ğŸ™‚</p>
<p>If you are not sure how to create a cron, check this link: <a href="http://www.magentocommerce.com/wiki/1">http://www.magentocommerce.com/wiki/1</a>_-_installation_and_configuration/how_to_setup_a_cron_job</p>

</content>
<p>
  
    <a class="blog-tags" href="/blog/magento-daily-backup-cron/">#magento daily backup cron</a>
  
    <a class="blog-tags" href="/blog/magento-database-backup-programatically/">#magento database backup programatically</a>
  
    <a class="blog-tags" href="/blog/magento-replace-old-database-backups/">#magento replace old database backups</a>
  
</p>




  </main>
  <footer><small>
  Copyright Â© 2020, Jane Doe. | 
</small></footer>

    
</body>

</html>
