<!DOCTYPE html>
<html lang="en-US">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" />
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="shortcut icon" href="http://localhost:1313/images/favicon.png" />
<title>Magento bug &amp;#8211; Checkout cart 500 error &amp;#8211; Redirect loops | Hugo ʕ•ᴥ•ʔ Bear Blog</title>
<meta name="title" content="Magento bug &amp;#8211; Checkout cart 500 error &amp;#8211; Redirect loops" />
<meta name="description" content="Magento checkout cart gives 500 error and redirect loops when there is a shopping cart rule with Category condition.
I found a bug in Magento which redirects shopping cart indefinitely causing it 500 internal server error. This can be a serious bug as customer will not able to shop if this happens. I noticed this happens when there is a shopping cart rule which have Category in conditions of the rule." />
<meta name="author" content="kalpesh" />
<meta name="keywords" content="500 internal server error,bug,magento,shopping cart," />






  
  <meta property="og:url" content="http://localhost:1313/posts/2015-03-28-magento-checkout-cart-500-error/">
  <meta property="og:site_name" content="Hugo ʕ•ᴥ•ʔ Bear Blog">
  <meta property="og:title" content="Magento bug &#8211; Checkout cart 500 error &#8211; Redirect loops">
  <meta property="og:description" content="Magento checkout cart gives 500 error and redirect loops when there is a shopping cart rule with Category condition.
I found a bug in Magento which redirects shopping cart indefinitely causing it 500 internal server error. This can be a serious bug as customer will not able to shop if this happens. I noticed this happens when there is a shopping cart rule which have Category in conditions of the rule.">
  <meta property="og:locale" content="en_US">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2015-03-28T23:52:11+00:00">
    <meta property="article:modified_time" content="2015-03-28T23:52:11+00:00">
    <meta property="article:tag" content="500 Internal Server Error">
    <meta property="article:tag" content="Bug">
    <meta property="article:tag" content="Magento">
    <meta property="article:tag" content="Shopping Cart">
    <meta property="og:image" content="http://localhost:1313/images/share.png">


  
  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/images/share.png">
  <meta name="twitter:title" content="Magento bug &#8211; Checkout cart 500 error &#8211; Redirect loops">
  <meta name="twitter:description" content="Magento checkout cart gives 500 error and redirect loops when there is a shopping cart rule with Category condition.
I found a bug in Magento which redirects shopping cart indefinitely causing it 500 internal server error. This can be a serious bug as customer will not able to shop if this happens. I noticed this happens when there is a shopping cart rule which have Category in conditions of the rule.">


  
  
  <meta itemprop="name" content="Magento bug &#8211; Checkout cart 500 error &#8211; Redirect loops">
  <meta itemprop="description" content="Magento checkout cart gives 500 error and redirect loops when there is a shopping cart rule with Category condition.
I found a bug in Magento which redirects shopping cart indefinitely causing it 500 internal server error. This can be a serious bug as customer will not able to shop if this happens. I noticed this happens when there is a shopping cart rule which have Category in conditions of the rule.">
  <meta itemprop="datePublished" content="2015-03-28T23:52:11+00:00">
  <meta itemprop="dateModified" content="2015-03-28T23:52:11+00:00">
  <meta itemprop="wordCount" content="280">
  <meta itemprop="image" content="http://localhost:1313/images/share.png">
  <meta itemprop="keywords" content="500 Internal Server Error,Bug,Magento,Shopping Cart">

<meta name="referrer" content="no-referrer-when-downgrade" />

  
  <link href="/original.min.css" rel="stylesheet">

  

  

  
</head>

<body>
  <header><a class="skip-link" href="#main-content">Skip to main content</a>

<a href="/" class="title"><h1>Hugo ʕ•ᴥ•ʔ Bear Blog</h1></a>
<nav>
<a href='http://localhost:1313/index.xml'>RSS</a>







</nav>
</header>
  <main id="main-content">

<h1>Magento bug &amp;#8211; Checkout cart 500 error &amp;#8211; Redirect loops</h1>
<p class="byline">
  <time datetime='2015-03-28' pubdate>
    2015-03-28
  </time>
  · kalpesh
</p>

<content>
  <p>Magento checkout cart gives 500 error and redirect loops when there is a shopping cart rule with Category condition.</p>
<p>I found a bug in Magento which redirects shopping cart indefinitely causing it 500 internal server error. This can be a serious bug as customer will not able to shop if this happens. I noticed this happens when there is a shopping cart rule which have Category in conditions of the rule.</p>
<p>If total quantity equals or greater than 1 for a subselection of items in cart matching ALL of these conditions:<br>
<strong>Category</strong> is 125</p>
<p>So for example you have a shopping cart rule where you want to give some discount or free product if at least one product is chosen from specific Category, this triggers the error in frontend shopping cart. Main reason here is <strong>Category</strong> condition. If you remove category condition then the error should go away. But if you want to keep the category condition and still want Magento to handle the shopping cart promotion rule, check the code changes below:</p>
<p>To solve this I copied below file to my local<br>
app/code/core/Mage/SalesRule/Model/Rule/Condition/Product/Combine.php</p>
<p>and edited the function validate:<br>
{code type=php}/**<br>
* Validate a condition with the checking of the child value<br>
* @param Varien_Object $object<br>
*<br>
* @return bool<br>
*/<br>
public function validate(Varien_Object $object)<br>
{<br>
/** @var Mage_Catalog_Model_Product $product */<br>
$product = $object-&gt;getProduct();<br>
if (!($product instanceof Mage_Catalog_Model_Product)) {<br>
$product = Mage::getModel(‘catalog/product’)-&gt;load($object-&gt;getProductId());<br>
}</p>
<p>$valid = parent::validate($object);</p>
<p>/* Kalpesh commented whole block, as it causes redirect loop and Segmentation fault in apache<br>
if (!$valid &amp;&amp; $product-&gt;getTypeId() == Mage_Catalog_Model_Product_Type_Configurable::TYPE_CODE) {<br>
$children = $object-&gt;getChildren();<br>
//$valid = $children &amp;&amp; $this-&gt;validate($children[0]); //Kalpesh commented, issue….<br>
}*/</p>
<p>return $valid;<br>
}{/code}</p>
<p>Hope this helps to some troubled souls!</p>

</content>
<p>
  
    <a class="blog-tags" href="/blog/500-internal-server-error/">#500 internal server error</a>
  
    <a class="blog-tags" href="/blog/bug/">#bug</a>
  
    <a class="blog-tags" href="/blog/magento/">#magento</a>
  
    <a class="blog-tags" href="/blog/shopping-cart/">#shopping cart</a>
  
</p>




  </main>
  <footer><small>
  Copyright © 2020, Jane Doe. | 
</small></footer>

    
</body>

</html>
