---
id: 943
title: '[Fix] Linux Bash Code Injection Vulnerability &#8211; ShellShock'
date: '2014-09-25T20:10:27+00:00'
author: kalpesh
layout: post
guid: 'http://ka.lpe.sh/?p=943'
permalink: /index.php/2014/09/25/fix-linux-bash-code-vulnerability-shellshock/
crp_related_posts:
    - '<div id="crp_related" class="crp_related"><h3>Related Posts:</h3><ul><li><a href="http://ka.lpe.sh/2012/11/02/linux-bash-script-to-get-email-address-and-created-updated-expires-dates-of-domain-name/"     class="crp_title">Linux: Bash script to get email address and created/updated/expires dates of domain name</a></li><li><a href="http://ka.lpe.sh/2012/11/02/linux-bash-script-to-check-availability-of-domain-names-in-differnet-tlds/"     class="crp_title">Linux: Bash script to check availability of domain names in differnet TLDs</a></li><li><a href="http://ka.lpe.sh/2013/06/12/php-redirect-without-header/"     class="crp_title">PHP redirect without header()</a></li><li><a href="http://ka.lpe.sh/2012/10/10/ubuntu-delete-temporary-cache-files/"     class="crp_title">Ubuntu: Delete temporary/cache files</a></li><li><a href="http://ka.lpe.sh/2013/02/09/linux-magento-daily-useful-development-commands/"     class="crp_title">Linux/Magento: Daily useful development commands</a></li></ul></div>'
categories:
    - Linux
tags:
    - 'bash shell'
    - linux
    - shellshock
    - vulnerability
---

ShellShock is new Linux vulnerability affecting all versions of Bash package. This vulnerability is worse than HeartBleed! This command line vulnerability is present in Mac OS X too. Basically it’s there in all the systems having Bash, a software used to control the command line in Unix.

To test if you are vulnerable to ShellShock, run this command:  
{{< highlight http >}} env x='() { :;}; echo vulnerable’ bash -c “echo this is a test”{{< /highlight >}}  
If you see output:  
{{< highlight http >}} vulnerable  
this is a test{{< /highlight >}}  
that means you are vulnerable!

Fix for Redhat packages:  
{{< highlight http >}} yum update bash{{< /highlight >}}

Fix for Ubuntu/Debian packages:  
{{< highlight http >}} apt-get upgrade bash{{< /highlight >}}

After running above commands, check again to see if you are vulnerable:  
{{< highlight http >}} env x='() { :;}; echo vulnerable’ bash -c “echo this is a test”{{< /highlight >}}

If you see below output, that means you are no longer vulnerable  
{{< highlight http >}} bash: warning: x: ignoring function definition attempt  
bash: error importing function definition for `x’  
this is a test{{< /highlight >}}